This is a experimental HSM daemon and migrate tool. It is meant to be
a platform for testing ideas in HSM migration.

Written by Andrew Tridgell, August 2008

Download
--------

To download the latest version of this code use git like this:

  git clone http://samba.org/~tridge/hacksm/.git

To update it later use "git pull"


Installation
------------

To use it first setup a shared filesystem with NFS to hold the HSM
"store", putting it in the HSM_STORE location from hacksm.h (the
default is /hacksm_store). This needs to be mounted on all nodes. You
can also use GPFS for this store, as long as the filesystem you use
doesn't have DMAPI enabled. 

Then start the HSM daemon like this:

   hacksmd &

You can then migrate files using hacksm_migrate, and view their state
using hacksm_ls

Note that if you have TSM installed you need to disable it. The simplest method is:

   onnode -p all mv /opt/tivoli /opt/tivoli.SAVED

then reboot. 

You will need to start hacksmd after mmstartup, but before you mount
the filesystem.

The file store
--------------

The "store" for hacksm is just a directory with files named by device
and inode number. When a file is migrated the data is moved to the
store and a dmapi hole is punched in the original file. This mimicks
the behaviour of real HSM daemons. When the hacksmd daemon gets a data
event (indicating that someone wants to read or write the data in the
file) then the data is restored from the "store" and the file can then
be read normally.
